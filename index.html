<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Fun arithmetic learning game for elementary kids">
    <meta name="theme-color" content="#ec4899">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Math Adventure">
    <title>Math Adventure - Learning Game</title>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIk1hdGggQWR2ZW50dXJlIiwKICAic2hvcnRfbmFtZSI6ICJNYXRoIEdhbWUiLAogICJkZXNjcmlwdGlvbiI6ICJGdW4gYXJpdGhtZXRpYyBsZWFybmluZyBnYW1lIGZvciBraWRzIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiM5MzMzZWEiLAogICJ0aGVtZV9jb2xvciI6ICIjZWM0ODk5IiwKICAib3JpZW50YXRpb24iOiAicG9ydHJhaXQiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWwsJTNDc3ZnJTIwd2lkdGg9JzE5MiclaGVpZ2h0PScxOTInJTIwdmlld0JveD0nMCUyMDAlMjAxOTIlMjAxOTInJTIweG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyUzRSUzQ3JlY3QlMjB3aWR0aD0nMTkyJyUyMGhlaWdodD0nMTkyJyUyMGZpbGw9JyU5MzMzZWEnJTIwcng9JzQwJy8lM0UlM0N0ZXh0JTIweD0nNTAlMjUnJTIweT0nNTAlMjUnJTIwZm9udC1zaXplPSc5MCclMjBmb250LWZhbWlseT0nQXJpYWwnJTIwdGV4dC1hbmNob3I9J21pZGRsZSclMjBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyUyMGZpbGw9J3doaXRlJyUzRSVGMCU5RiU5QSU4MCUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyUyMHdpZHRoPSc1MTInJTIwaGVpZ2h0PSc1MTInJTIwdmlld0JveD0nMCUyMDAlMjA1MTIlMjA1MTInJTIweG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyUzRSUzQ3JlY3QlMjB3aWR0aD0nNTEyJyUyMGhlaWdodD0nNTEyJyUyMGZpbGw9JyU5MzMzZWEnJTIwcng9JzEwMCcvJTNFJTNDdGV4dCUyMHg9JzUwJTI1JyUyMHk9JzUwJTI1JyUyMGZvbnQtc2l6ZT0nMjQwJyUyMGZvbnQtZmFtaWx5PSdBcmlhbCclMjB0ZXh0LWFuY2hvcj0nbWlkZGxlJyUyMGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnJTIwZmlsbD0nd2hpdGUnJTNFJUYwJTlGJTlBJTgwJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons as inline SVG components
        const Star = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
            </svg>
        );

        const Trophy = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" />
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" />
                <path d="M4 22h16" />
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" />
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" />
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" />
            </svg>
        );

        const Settings = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                <circle cx="12" cy="12" r="3" />
            </svg>
        );

        const Sparkles = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />
                <path d="M5 3v4" />
                <path d="M19 17v4" />
                <path d="M3 5h4" />
                <path d="M17 19h4" />
            </svg>
        );

        function ArithmeticGame() {
            const [operation, setOperation] = useState('addition');
            const [difficulty, setDifficulty] = useState(1);
            const [numCount, setNumCount] = useState(2);
            const [numbers, setNumbers] = useState([]);
            const [userAnswer, setUserAnswer] = useState('');
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);
            const [feedback, setFeedback] = useState('');
            const [showConfetti, setShowConfetti] = useState(false);
            const [showSettings, setShowSettings] = useState(false);

            const getMaxNumber = () => {
                switch(difficulty) {
                    case 1: return 10;
                    case 2: return 20;
                    case 3: return 50;
                    case 4: return 100;
                    case 5: return 500;
                    case 6: return 10000;
                    default: return 10;
                }
            };

            const generateProblem = () => {
                let nums = [];
                const count = (operation === 'addition' || operation === 'subtraction') ? numCount : 2;
                const max = getMaxNumber();
                
                switch(operation) {
                    case 'addition':
                        for (let i = 0; i < count; i++) {
                            nums.push(Math.floor(Math.random() * max) + 1);
                        }
                        break;
                        
                    case 'subtraction':
                        let total = Math.floor(Math.random() * max) + count * Math.max(5, max / 10);
                        nums.push(total);
                        for (let i = 1; i < count; i++) {
                            const sub = Math.floor(Math.random() * Math.min(total / (count - i + 1), max / 2)) + 1;
                            nums.push(sub);
                            total -= sub;
                        }
                        break;
                        
                    case 'multiplication':
                        nums.push(Math.floor(Math.random() * max) + 1);
                        nums.push(Math.floor(Math.random() * max) + 1);
                        break;
                        
                    case 'division':
                        const divisor = Math.floor(Math.random() * max) + 1;
                        const quotient = Math.floor(Math.random() * max) + 1;
                        nums.push(divisor * quotient);
                        nums.push(divisor);
                        break;
                }
                
                setNumbers(nums);
                setUserAnswer('');
                setFeedback('');
            };

            useEffect(() => {
                generateProblem();
            }, [operation, difficulty, numCount]);

            const getCorrectAnswer = () => {
                if (numbers.length === 0) return 0;
                
                switch(operation) {
                    case 'addition':
                        return numbers.reduce((sum, num) => sum + num, 0);
                    case 'subtraction':
                        return numbers.reduce((diff, num, idx) => idx === 0 ? num : diff - num, 0);
                    case 'multiplication':
                        return numbers[0] * numbers[1];
                    case 'division':
                        return numbers[0] / numbers[1];
                    default:
                        return 0;
                }
            };

            const getSymbol = () => {
                switch(operation) {
                    case 'addition': return '+';
                    case 'subtraction': return 'âˆ’';
                    case 'multiplication': return 'Ã—';
                    case 'division': return 'Ã·';
                    default: return '+';
                }
            };

            const getProblemDisplay = () => {
                if (numbers.length === 0) return '';
                return numbers.map((num, idx) => (
                    <span key={idx}>
                        {idx > 0 && ` ${getSymbol()} `}
                        {num}
                    </span>
                ));
            };

            const handleSubmit = () => {
                const correct = getCorrectAnswer();
                const answer = parseFloat(userAnswer);

                if (answer === correct) {
                    setScore(score + 1);
                    setStreak(streak + 1);
                    setFeedback('ðŸŽ‰ Correct! Great job!');
                    setShowConfetti(true);
                    setTimeout(() => {
                        setShowConfetti(false);
                        generateProblem();
                    }, 1500);
                } else {
                    setStreak(0);
                    setFeedback(`Not quite! The answer is ${correct}. Try the next one!`);
                    setTimeout(() => {
                        generateProblem();
                    }, 2000);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && userAnswer) {
                    handleSubmit();
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-400 via-pink-400 to-blue-400 p-4">
                    <div className="max-w-2xl mx-auto">
                        <div className="bg-white rounded-3xl shadow-2xl p-8 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h1 className="text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                                    Math Adventure! ðŸš€
                                </h1>
                                <button
                                    onClick={() => setShowSettings(!showSettings)}
                                    className="p-3 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors"
                                >
                                    <Settings className="w-6 h-6 text-gray-700" />
                                </button>
                            </div>

                            {showSettings && (
                                <div className="mb-6 p-4 bg-gray-50 rounded-2xl space-y-4">
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">
                                            Difficulty Level: {difficulty}
                                        </label>
                                        <div className="grid grid-cols-3 gap-2">
                                            {[1, 2, 3, 4, 5, 6].map((level) => (
                                                <button
                                                    key={level}
                                                    onClick={() => setDifficulty(level)}
                                                    className={`px-3 py-3 rounded-lg font-semibold transition-all text-sm ${
                                                        difficulty === level
                                                            ? 'bg-purple-500 text-white'
                                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                                    }`}
                                                >
                                                    <div>Level {level}</div>
                                                    <div className="text-xs opacity-80">
                                                        {level === 1 && '< 10'}
                                                        {level === 2 && '< 20'}
                                                        {level === 3 && '< 50'}
                                                        {level === 4 && '< 100'}
                                                        {level === 5 && '< 500'}
                                                        {level === 6 && '< 10k'}
                                                    </div>
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {(operation === 'addition' || operation === 'subtraction') && (
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">
                                                Number of Numbers: {numCount}
                                            </label>
                                            <input
                                                type="range"
                                                min="2"
                                                max="5"
                                                value={numCount}
                                                onChange={(e) => setNumCount(parseInt(e.target.value))}
                                                className="w-full"
                                            />
                                            <div className="flex justify-between text-xs text-gray-500 mt-1">
                                                <span>2</span>
                                                <span>3</span>
                                                <span>4</span>
                                                <span>5</span>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                            
                            <div className="flex justify-around mb-6 bg-yellow-100 rounded-2xl p-4">
                                <div className="text-center">
                                    <Trophy className="w-8 h-8 mx-auto text-yellow-600 mb-1" />
                                    <p className="text-sm text-gray-600">Score</p>
                                    <p className="text-2xl font-bold text-purple-600">{score}</p>
                                </div>
                                <div className="text-center">
                                    <Star className="w-8 h-8 mx-auto text-orange-500 mb-1" />
                                    <p className="text-sm text-gray-600">Streak</p>
                                    <p className="text-2xl font-bold text-orange-600">{streak}</p>
                                </div>
                            </div>

                            <div className="flex flex-wrap gap-2 mb-6">
                                {['addition', 'subtraction', 'multiplication', 'division'].map((op) => (
                                    <button
                                        key={op}
                                        onClick={() => setOperation(op)}
                                        className={`flex-1 px-4 py-3 rounded-xl font-semibold transition-all ${
                                            operation === op
                                                ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg scale-105'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        {op.charAt(0).toUpperCase() + op.slice(1)}
                                    </button>
                                ))}
                            </div>

                            <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8 mb-6">
                                <div className="text-center mb-6">
                                    <p className="text-5xl font-bold text-gray-800 mb-4">
                                        {getProblemDisplay()} = ?
                                    </p>
                                </div>

                                <div className="space-y-4">
                                    <input
                                        type="number"
                                        value={userAnswer}
                                        onChange={(e) => setUserAnswer(e.target.value)}
                                        onKeyPress={handleKeyPress}
                                        placeholder="Type your answer..."
                                        className="w-full px-6 py-4 text-2xl text-center border-4 border-purple-300 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-4 focus:ring-purple-200"
                                        autoFocus
                                    />
                                    <button
                                        onClick={handleSubmit}
                                        disabled={!userAnswer}
                                        className="w-full bg-gradient-to-r from-green-400 to-blue-500 text-white py-4 px-6 rounded-xl text-xl font-bold hover:from-green-500 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-all shadow-lg"
                                    >
                                        Check Answer âœ“
                                    </button>
                                </div>
                            </div>

                            {feedback && (
                                <div className={`text-center p-4 rounded-xl text-lg font-semibold ${
                                    feedback.includes('Correct') 
                                        ? 'bg-green-100 text-green-700' 
                                        : 'bg-blue-100 text-blue-700'
                                }`}>
                                    {feedback}
                                </div>
                            )}
                        </div>

                        {showConfetti && (
                            <div className="fixed inset-0 pointer-events-none flex items-center justify-center">
                                <Sparkles className="w-32 h-32 text-yellow-400 animate-ping" />
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<ArithmeticGame />, document.getElementById('root'));
    </script>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE_NAME = 'math-adventure-v1';
                    const urlsToCache = ['/'];
                    
                    self.addEventListener('install', (event) => {
                        event.waitUntil(
                            caches.open(CACHE_NAME).then((cache) => cache.addAll(urlsToCache))
                        );
                    });
                    
                    self.addEventListener('fetch', (event) => {
                        event.respondWith(
                            caches.match(event.request).then((response) => {
                                return response || fetch(event.request);
                            })
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl).then(() => {
                    console.log('Service Worker registered successfully');
                }).catch((error) => {
                    console.log('Service Worker registration failed:', error);
                });
            });
        }
    </script>
</body>
</html>
