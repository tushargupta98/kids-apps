<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Practice - Grade 1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
        }
        
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .question-type-selector {
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            font-size: 1.1em;
        }
        
        select {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #667eea;
            border-radius: 10px;
            background: white;
            cursor: pointer;
        }
        
        .question-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .question-text {
            font-size: 1.8em;
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .vertical-math {
            display: inline-block;
            font-family: monospace;
            font-size: 2em;
            text-align: right;
            line-height: 1.4;
            border: 3px solid #667eea;
            padding: 20px 30px;
            background: white;
            border-radius: 10px;
        }
        
        .vertical-math .operator {
            border-top: 3px solid #333;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .digit-boxes {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin-top: 10px;
            outline: none;
        }
        
        #digitBoxContainer {
            outline: none;
            cursor: pointer;
        }
        
        #digitBoxContainer:focus {
            outline: none;
        }
        
        .digit-box {
            width: 60px;
            height: 70px;
            border: 3px solid #667eea;
            background: white;
            font-size: 2em;
            text-align: center;
            border-radius: 8px;
            font-family: monospace;
            line-height: 70px;
        }
        
        .digit-box.active {
            border-color: #10b981;
            background: #d1fae5;
        }
        
        .digit-box.filled {
            background: #f3f4f6;
        }
        
        .answer-input {
            width: 100%;
            padding: 20px;
            font-size: 1.5em;
            text-align: center;
            border: 3px solid #667eea;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        button {
            flex: 1;
            padding: 18px;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .check-btn {
            background: #10b981;
            color: white;
        }
        
        .check-btn:hover {
            background: #059669;
            transform: translateY(-2px);
        }
        
        .next-btn {
            background: #667eea;
            color: white;
        }
        
        .next-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .skip-btn {
            background: #f59e0b;
            color: white;
        }
        
        .skip-btn:hover {
            background: #d97706;
            transform: translateY(-2px);
        }
        
        .feedback {
            text-align: center;
            font-size: 1.5em;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .feedback.correct {
            background: #d1fae5;
            color: #065f46;
        }
        
        .feedback.incorrect {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: #f3f4f6;
            padding: 20px;
            border-radius: 10px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .celebration {
            text-align: center;
            font-size: 3em;
            margin: 20px 0;
        }
        
        .odd-even-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .question-text {
                font-size: 1.4em;
            }
            
            button {
                font-size: 1em;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéì Math Practice</h1>
        <p class="subtitle">Advanced Grade 1 ‚Ä¢ Interactive Learning</p>
        
        <div class="question-type-selector">
            <label for="questionType">Choose a Question Type:</label>
            <select id="questionType" onchange="startNewType()">
                <option value="addition">Addition within 100</option>
                <option value="subtraction">Subtraction within 100</option>
                <option value="skip2">Skip Counting by 2s</option>
                <option value="skip5">Skip Counting by 5s</option>
                <option value="skip10">Skip Counting by 10s</option>
                <option value="skip3">Skip Counting by 3s</option>
                <option value="placeMore">Place Value - 10 More</option>
                <option value="placeLess">Place Value - 10 Less</option>
                <option value="missingAdd">Missing Addend</option>
                <option value="missingSub">Missing Subtrahend</option>
                <option value="compare">Number Comparison</option>
                <option value="repeated">Repeated Addition</option>
                <option value="wordAdd">Word Problem - Addition</option>
                <option value="wordSub">Word Problem - Subtraction</option>
                <option value="twoStep">Two-Step Word Problem</option>
                <option value="pattern">Number Pattern</option>
                <option value="oddEven">Odd or Even</option>
                <option value="greaterLess">Greater or Less</option>
                <option value="coins">Counting Coins</option>
                <option value="timeHour">Time - Hour</option>
                <option value="timeHalf">Time - Half Hour</option>
                <option value="measurement">Measurement Comparison</option>
                <option value="halves">Fractions - Halves</option>
                <option value="quarters">Fractions - Quarters</option>
                <option value="shapes">Shape Sides</option>
                <option value="perimeter">Perimeter</option>
                <option value="estimation">Estimation</option>
                <option value="rounding">Rounding to Nearest 10</option>
                <option value="inverse">Inverse Operations</option>
                <option value="commutative">Commutative Property</option>
                <option value="making10">Making 10</option>
                <option value="doubles">Doubles</option>
                <option value="nearDoubles">Near Doubles</option>
            </select>
        </div>
        
        <div class="question-card">
            <div class="question-text" id="questionText"></div>
            <div id="digitBoxContainer" style="display: none;" tabindex="0"></div>
            <div id="oddEvenButtons" style="display: none; justify-content: center; gap: 20px; margin-bottom: 20px;">
                <button class="odd-even-btn" onclick="selectOddEven('odd')" style="background: #f59e0b; color: white; padding: 20px 40px; font-size: 1.5em; border: none; border-radius: 10px; cursor: pointer;">Odd</button>
                <button class="odd-even-btn" onclick="selectOddEven('even')" style="background: #3b82f6; color: white; padding: 20px 40px; font-size: 1.5em; border: none; border-radius: 10px; cursor: pointer;">Even</button>
            </div>
            <input type="text" id="answerInput" class="answer-input" placeholder="Type your answer here..." onkeypress="handleEnter(event)">
        </div>
        
        <div id="feedback" class="feedback" style="display: none;"></div>
        
        <div class="button-group">
            <button class="check-btn" onclick="checkAnswer()">‚úì Check Answer</button>
            <button class="next-btn" onclick="nextQuestion()">‚Üí Next Question</button>
            <button class="skip-btn" onclick="skipQuestion()">‚á¢ Skip</button>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="correctCount">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Attempted</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="streakCount">0</div>
                <div class="stat-label">Streak</div>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = {};
        let correctAnswer = '';
        let stats = { correct: 0, total: 0, streak: 0 };
        let answered = false;
        let digitBoxValues = [];
        let currentDigitIndex = -1;

        const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const randEven = (min, max) => {
            let num = rand(min, max);
            return num % 2 === 0 ? num : (num < max ? num + 1 : num - 1);
        };

        function generateQuestion(type) {
            let question = '';
            let answer = '';
            
            switch(type) {
                case 'addition':
                    const a1 = rand(10, 89);
                    const a2 = rand(10, 100 - a1);
                    question = `<div class="vertical-math">  ${a1}<br>+ ${a2}<br><div class="operator">____</div></div>`;
                    answer = (a1 + a2).toString();
                    break;
                    
                case 'subtraction':
                    const s1 = rand(20, 100);
                    const s2 = rand(10, s1 - 10);
                    question = `<div class="vertical-math">  ${s1}<br>- ${s2}<br><div class="operator">____</div></div>`;
                    answer = (s1 - s2).toString();
                    break;
                    
                case 'skip2':
                    const start2 = randEven(2, 20);
                    question = `Count by 2s: ${start2}, ${start2+2}, ${start2+4}, ?, ?, ?`;
                    answer = `${start2+6}, ${start2+8}, ${start2+10}`;
                    break;
                    
                case 'skip5':
                    const start5 = rand(0, 10) * 5;
                    question = `Count by 5s: ${start5}, ${start5+5}, ${start5+10}, ?, ?, ?`;
                    answer = `${start5+15}, ${start5+20}, ${start5+25}`;
                    break;
                    
                case 'skip10':
                    const start10 = rand(0, 5) * 10;
                    question = `Count by 10s: ${start10}, ${start10+10}, ${start10+20}, ?, ?, ?`;
                    answer = `${start10+30}, ${start10+40}, ${start10+50}`;
                    break;
                    
                case 'skip3':
                    const start3 = rand(0, 5) * 3;
                    question = `Count by 3s: ${start3}, ${start3+3}, ${start3+6}, ?, ?, ?`;
                    answer = `${start3+9}, ${start3+12}, ${start3+15}`;
                    break;
                    
                case 'placeMore':
                    const pv1 = rand(20, 89);
                    question = `What is 10 more than ${pv1}?`;
                    answer = (pv1 + 10).toString();
                    break;
                    
                case 'placeLess':
                    const pv2 = rand(20, 99);
                    question = `What is 10 less than ${pv2}?`;
                    answer = (pv2 - 10).toString();
                    break;
                    
                case 'missingAdd':
                    const ma1 = rand(10, 50);
                    const ma2 = rand(10, 40);
                    question = `${ma1} + ? = ${ma1 + ma2}`;
                    answer = ma2.toString();
                    break;
                    
                case 'missingSub':
                    const ms1 = rand(30, 80);
                    const ms2 = rand(10, 30);
                    question = `${ms1} - ? = ${ms1 - ms2}`;
                    answer = ms2.toString();
                    break;
                    
                case 'compare':
                    const nc1 = rand(20, 99);
                    const nc2 = rand(20, 99);
                    question = `Which is greater: ${nc1} or ${nc2}?`;
                    answer = nc1 > nc2 ? nc1.toString() : nc2.toString();
                    break;
                    
                case 'repeated':
                    const groups = rand(2, 5);
                    const perGroup = rand(3, 8);
                    question = `${groups} groups of ${perGroup}. How many total?`;
                    answer = (groups * perGroup).toString();
                    break;
                    
                case 'wordAdd':
                    const wp1 = rand(15, 50);
                    const wp2 = rand(10, 40);
                    const items = ['stickers', 'marbles', 'pencils', 'books', 'toys'][rand(0, 4)];
                    question = `Sam has ${wp1} ${items}. He gets ${wp2} more. How many does he have now?`;
                    answer = (wp1 + wp2).toString();
                    break;
                    
                case 'wordSub':
                    const wp3 = rand(30, 70);
                    const wp4 = rand(10, 30);
                    const items2 = ['candies', 'cards', 'coins', 'crayons', 'blocks'][rand(0, 4)];
                    question = `Emma has ${wp3} ${items2}. She gives away ${wp4}. How many are left?`;
                    answer = (wp3 - wp4).toString();
                    break;
                    
                case 'twoStep':
                    const ts1 = rand(10, 30);
                    const ts2 = rand(5, 20);
                    const ts3 = rand(5, 15);
                    question = `Jake had ${ts1} apples. He got ${ts2} more, then ate ${ts3}. How many apples does he have?`;
                    answer = (ts1 + ts2 - ts3).toString();
                    break;
                    
                case 'pattern':
                    const diff = [2, 3, 4, 5, 10][rand(0, 4)];
                    const np1 = rand(1, 20);
                    question = `Complete the pattern: ${np1}, ${np1+diff}, ${np1+diff*2}, ?, ?, ?`;
                    answer = `${np1+diff*3}, ${np1+diff*4}, ${np1+diff*5}`;
                    break;
                    
                case 'oddEven':
                    const oe = rand(10, 99);
                    question = `Is ${oe} odd or even?`;
                    answer = oe % 2 === 0 ? 'even' : 'odd';
                    break;
                    
                case 'greaterLess':
                    const gt1 = rand(20, 80);
                    const gt2 = rand(20, 80);
                    const symbol = gt1 > gt2 ? 'greater' : 'less';
                    question = `Is ${gt1} greater or less than ${gt2}?`;
                    answer = symbol;
                    break;
                    
                case 'coins':
                    const pennies = rand(0, 10);
                    const nickels = rand(0, 5);
                    const dimes = rand(0, 5);
                    question = `${pennies} pennies + ${nickels} nickels + ${dimes} dimes = ? cents`;
                    answer = (pennies * 1 + nickels * 5 + dimes * 10).toString();
                    break;
                    
                case 'timeHour':
                    const hour = rand(1, 12);
                    question = `What time is shown: ${hour}:00? (Write the hour)`;
                    answer = hour.toString();
                    break;
                    
                case 'timeHalf':
                    const hour2 = rand(1, 12);
                    question = `What hour comes with ${hour2}:30?`;
                    answer = hour2.toString();
                    break;
                    
                case 'measurement':
                    const m1 = rand(5, 20);
                    const m2 = rand(5, 20);
                    const obj1 = ['pencil', 'eraser', 'crayon', 'marker'][rand(0, 3)];
                    const obj2 = ['book', 'ruler', 'paper', 'notebook'][rand(0, 3)];
                    question = `A ${obj1} is ${m1} cm. A ${obj2} is ${m2} cm. Which is longer?`;
                    answer = m1 > m2 ? obj1 : obj2;
                    break;
                    
                case 'halves':
                    const total = randEven(4, 12);
                    question = `Half of ${total} = ?`;
                    answer = (total / 2).toString();
                    break;
                    
                case 'quarters':
                    const total2 = [4, 8, 12, 16, 20][rand(0, 4)];
                    question = `One quarter of ${total2} = ?`;
                    answer = (total2 / 4).toString();
                    break;
                    
                case 'shapes':
                    const shapes = [
                        { name: 'triangle', sides: 3 },
                        { name: 'square', sides: 4 },
                        { name: 'rectangle', sides: 4 },
                        { name: 'pentagon', sides: 5 },
                        { name: 'hexagon', sides: 6 }
                    ];
                    const shape = shapes[rand(0, shapes.length - 1)];
                    question = `How many sides does a ${shape.name} have?`;
                    answer = shape.sides.toString();
                    break;
                    
                case 'perimeter':
                    const side1 = rand(3, 10);
                    const side2 = rand(3, 10);
                    question = `Rectangle: length = ${side1} cm, width = ${side2} cm. What is the perimeter?`;
                    answer = ((side1 + side2) * 2).toString();
                    break;
                    
                case 'estimation':
                    const e1 = rand(20, 45);
                    const e2 = rand(20, 45);
                    const sum = e1 + e2;
                    const closest = sum < 50 ? 40 : (sum < 70 ? 60 : 80);
                    question = `${e1} + ${e2} is closest to: 40, 60, or 80?`;
                    answer = closest.toString();
                    break;
                    
                case 'rounding':
                    const r = rand(22, 88);
                    const rounded = Math.round(r / 10) * 10;
                    question = `Round ${r} to the nearest ten`;
                    answer = rounded.toString();
                    break;
                    
                case 'inverse':
                    const io1 = rand(5, 15);
                    const io2 = rand(5, 15);
                    question = `If ${io1} + ${io2} = ${io1 + io2}, then ${io1 + io2} - ${io1} = ?`;
                    answer = io2.toString();
                    break;
                    
                case 'commutative':
                    const tf1 = rand(3, 12);
                    const tf2 = rand(3, 12);
                    question = `True or False: ${tf1} + ${tf2} = ${tf2} + ${tf1}`;
                    answer = 'true';
                    break;
                    
                case 'making10':
                    const mt = rand(1, 9);
                    question = `${mt} + ? = 10`;
                    answer = (10 - mt).toString();
                    break;
                    
                case 'doubles':
                    const db = rand(5, 20);
                    question = `Double ${db} = ?`;
                    answer = (db * 2).toString();
                    break;
                    
                case 'nearDoubles':
                    const nd = rand(5, 15);
                    question = `${nd} + ${nd + 1} = ?`;
                    answer = (nd + nd + 1).toString();
                    break;
            }
            
            return { question, answer };
        }

        function startNewType() {
            document.removeEventListener('keydown', handleDigitInput);
            stats = { correct: 0, total: 0, streak: 0 };
            updateStats();
            nextQuestion();
        }

        function nextQuestion() {
            const type = document.getElementById('questionType').value;
            const q = generateQuestion(type);
            currentQuestion = q;
            correctAnswer = q.answer.toLowerCase().trim();
            
            document.getElementById('questionText').textContent = q.question;
            document.getElementById('answerInput').value = '';
            document.getElementById('feedback').style.display = 'none';
            answered = false;
            
            // Show odd/even buttons only for oddEven question type
            const oddEvenButtons = document.getElementById('oddEvenButtons');
            const answerInput = document.getElementById('answerInput');
            const digitBoxContainer = document.getElementById('digitBoxContainer');
            
            if (type === 'oddEven') {
                oddEvenButtons.style.display = 'flex';
                answerInput.style.display = 'none';
                digitBoxContainer.style.display = 'none';
            } else if (type === 'addition' || type === 'subtraction') {
                // Show digit boxes for addition/subtraction
                oddEvenButtons.style.display = 'none';
                answerInput.style.display = 'none';
                digitBoxContainer.style.display = 'block';
                document.getElementById('questionText').innerHTML = q.question;
                
                // Remove old listener before adding new one
                document.removeEventListener('keydown', handleDigitInput);
                document.addEventListener('keydown', handleDigitInput);
                
                createDigitBoxes(correctAnswer.length);
                
                // Focus after a brief delay to ensure DOM is ready
                setTimeout(() => {
                    digitBoxContainer.focus();
                }, 150);
            } else {
                oddEvenButtons.style.display = 'none';
                answerInput.style.display = 'block';
                digitBoxContainer.style.display = 'none';
                answerInput.focus();
            }
            
            // Use innerHTML for vertical math formatting
            if (type === 'addition' || type === 'subtraction') {
                document.getElementById('questionText').innerHTML = q.question;
            }
        }
        
        function createDigitBoxes(numDigits) {
            const container = document.getElementById('digitBoxContainer');
            digitBoxValues = new Array(numDigits).fill('');
            currentDigitIndex = numDigits - 1; // Start from rightmost
            
            container.innerHTML = '<div class="digit-boxes" id="digitBoxesInner">' + 
                Array(numDigits).fill(0).map((_, i) => 
                    `<div class="digit-box" id="digitBox${i}"></div>`
                ).join('') + 
                '</div>';
            
            updateDigitBoxes();
            
            // Make container clickable and focusable
            container.onclick = function() {
                container.focus();
            };
        }
        
        function updateDigitBoxes() {
            digitBoxValues.forEach((val, i) => {
                const box = document.getElementById(`digitBox${i}`);
                if (box) {
                    box.textContent = val;
                    box.className = 'digit-box';
                    if (i === currentDigitIndex) {
                        box.classList.add('active');
                    } else if (val !== '') {
                        box.classList.add('filled');
                    }
                }
            });
        }
        
        function handleDigitInput(event) {
            const type = document.getElementById('questionType').value;
            if (answered || (type !== 'addition' && type !== 'subtraction')) return;
            
            const key = event.key;
            
            // Handle number input
            if (key >= '0' && key <= '9') {
                if (currentDigitIndex >= 0) {
                    digitBoxValues[currentDigitIndex] = key;
                    currentDigitIndex--;
                    updateDigitBoxes();
                    
                    // Auto-check when all boxes filled
                    if (currentDigitIndex < 0) {
                        setTimeout(() => {
                            document.getElementById('answerInput').value = digitBoxValues.join('');
                            checkAnswer();
                        }, 300);
                    }
                }
                event.preventDefault();
                return false;
            }
            // Handle backspace
            else if (key === 'Backspace') {
                if (currentDigitIndex < digitBoxValues.length - 1) {
                    currentDigitIndex++;
                }
                digitBoxValues[currentDigitIndex] = '';
                updateDigitBoxes();
                event.preventDefault();
                return false;
            }
        }
        
        function selectOddEven(choice) {
            if (answered) return;
            document.getElementById('answerInput').value = choice;
            checkAnswer();
        }

        function checkAnswer() {
            if (answered) return;
            
            const userAnswer = document.getElementById('answerInput').value.toLowerCase().trim();
            const feedback = document.getElementById('feedback');
            
            if (!userAnswer) {
                feedback.textContent = '‚ö†Ô∏è Please enter an answer!';
                feedback.className = 'feedback incorrect';
                feedback.style.display = 'block';
                return;
            }
            
            answered = true;
            stats.total++;
            
            if (userAnswer === correctAnswer) {
                stats.correct++;
                stats.streak++;
                feedback.innerHTML = `üéâ Correct! Great job!`;
                feedback.className = 'feedback correct';
                
                if (stats.streak === 5) {
                    feedback.innerHTML += `<div class="celebration">üåü 5 in a row! You're amazing! üåü</div>`;
                }
            } else {
                stats.streak = 0;
                feedback.innerHTML = `‚ùå Not quite. The answer is: <strong>${correctAnswer}</strong>`;
                feedback.className = 'feedback incorrect';
            }
            
            feedback.style.display = 'block';
            updateStats();
        }

        function skipQuestion() {
            document.removeEventListener('keydown', handleDigitInput);
            nextQuestion();
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                if (!answered) {
                    checkAnswer();
                } else {
                    nextQuestion();
                }
            }
        }

        function updateStats() {
            document.getElementById('correctCount').textContent = stats.correct;
            document.getElementById('totalCount').textContent = stats.total;
            document.getElementById('streakCount').textContent = stats.streak;
        }

        // Initialize with first question
        nextQuestion();
    </script>
</body>
</html>
